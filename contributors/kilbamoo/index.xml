<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>kilbamoo on</title><link>https://nrchkb.github.io/contributors/kilbamoo/</link><description>Recent content in kilbamoo on</description><generator>Hugo -- gohugo.io</generator><language>en</language><lastBuildDate>Sat, 17 Apr 2021 18:50:12 +0000</lastBuildDate><atom:link href="https://nrchkb.github.io/contributors/kilbamoo/index.xml" rel="self" type="application/rss+xml"/><item><title>Light Sensor</title><link>https://nrchkb.github.io/wiki/service/light-sensor/</link><pubDate>Sat, 17 Apr 2021 18:50:12 +0000</pubDate><guid>https://nrchkb.github.io/wiki/service/light-sensor/</guid><description>Examples Example below uses tasmota firmware on an esp board to get ambient light level. Using TSL2561 light sensor. Modify mqtt topic, mqtt broker, homekit bridge name as needed. First it gets the mqtt topic, converts it to json. From payload, we subtract the luminance and convert it to an integer with expected property for light sensor.
[{&amp;#34;id&amp;#34;:&amp;#34;c11c22b3.917f2&amp;#34;,&amp;#34;type&amp;#34;:&amp;#34;mqtt in&amp;#34;,&amp;#34;z&amp;#34;:&amp;#34;8ac667fa.c2cec8&amp;#34;,&amp;#34;name&amp;#34;:&amp;#34;sonoff12&amp;#34;,&amp;#34;topic&amp;#34;:&amp;#34;tele/sonoff12/SENSOR&amp;#34;,&amp;#34;qos&amp;#34;:&amp;#34;2&amp;#34;,&amp;#34;datatype&amp;#34;:&amp;#34;auto&amp;#34;,&amp;#34;broker&amp;#34;:&amp;#34;1e53b5d8.56e33a&amp;#34;,&amp;#34;x&amp;#34;:76,&amp;#34;y&amp;#34;:412,&amp;#34;wires&amp;#34;:[[&amp;#34;79b3e787.48c528&amp;#34;]]},{&amp;#34;id&amp;#34;:&amp;#34;79b3e787.48c528&amp;#34;,&amp;#34;type&amp;#34;:&amp;#34;json&amp;#34;,&amp;#34;z&amp;#34;:&amp;#34;8ac667fa.c2cec8&amp;#34;,&amp;#34;name&amp;#34;:&amp;#34;&amp;#34;,&amp;#34;property&amp;#34;:&amp;#34;payload&amp;#34;,&amp;#34;action&amp;#34;:&amp;#34;&amp;#34;,&amp;#34;pretty&amp;#34;:false,&amp;#34;x&amp;#34;:239,&amp;#34;y&amp;#34;:413,&amp;#34;wires&amp;#34;:[[&amp;#34;6eb3b1bc.61b1d&amp;#34;]]},{&amp;#34;id&amp;#34;:&amp;#34;9f8da133.70e86&amp;#34;,&amp;#34;type&amp;#34;:&amp;#34;debug&amp;#34;,&amp;#34;z&amp;#34;:&amp;#34;8ac667fa.c2cec8&amp;#34;,&amp;#34;name&amp;#34;:&amp;#34;&amp;#34;,&amp;#34;active&amp;#34;:false,&amp;#34;tosidebar&amp;#34;:true,&amp;#34;console&amp;#34;:false,&amp;#34;tostatus&amp;#34;:false,&amp;#34;complete&amp;#34;:&amp;#34;payload&amp;#34;,&amp;#34;targetType&amp;#34;:&amp;#34;msg&amp;#34;,&amp;#34;x&amp;#34;:646,&amp;#34;y&amp;#34;:475,&amp;#34;wires&amp;#34;:[]},{&amp;#34;id&amp;#34;:&amp;#34;6eb3b1bc.61b1d&amp;#34;,&amp;#34;type&amp;#34;:&amp;#34;function&amp;#34;,&amp;#34;z&amp;#34;:&amp;#34;8ac667fa.c2cec8&amp;#34;,&amp;#34;name&amp;#34;:&amp;#34;GetLumi&amp;#34;,&amp;#34;func&amp;#34;:&amp;#34;msg.payload = {\n CurrentAmbientLightLevel\t: parseInt(msg.payload.TSL2561.Illuminance)\n}\nreturn msg;\n&amp;#34;,&amp;#34;outputs&amp;#34;:1,&amp;#34;noerr&amp;#34;:0,&amp;#34;x&amp;#34;:403,&amp;#34;y&amp;#34;:413,&amp;#34;wires&amp;#34;:[[&amp;#34;9f8da133.70e86&amp;#34;,&amp;#34;8742cf23.9c419&amp;#34;]]},{&amp;#34;id&amp;#34;:&amp;#34;8742cf23.9c419&amp;#34;,&amp;#34;type&amp;#34;:&amp;#34;homekit-service&amp;#34;,&amp;#34;z&amp;#34;:&amp;#34;8ac667fa.c2cec8&amp;#34;,&amp;#34;isParent&amp;#34;:true,&amp;#34;bridge&amp;#34;:&amp;#34;4c36a4e3.de153c&amp;#34;,&amp;#34;parentService&amp;#34;:&amp;#34;&amp;#34;,&amp;#34;name&amp;#34;:&amp;#34;LichtNiveau&amp;#34;,&amp;#34;serviceName&amp;#34;:&amp;#34;LightSensor&amp;#34;,&amp;#34;topic&amp;#34;:&amp;#34;&amp;#34;,&amp;#34;filter&amp;#34;:false,&amp;#34;manufacturer&amp;#34;:&amp;#34;JeroVanl&amp;#34;,&amp;#34;model&amp;#34;:&amp;#34;TSL2561&amp;#34;,&amp;#34;serialNo&amp;#34;:&amp;#34;01/04/2019&amp;#34;,&amp;#34;characteristicProperties&amp;#34;:&amp;#34;{}&amp;#34;,&amp;#34;x&amp;#34;:652,&amp;#34;y&amp;#34;:414,&amp;#34;wires&amp;#34;:[[]]},{&amp;#34;id&amp;#34;:&amp;#34;1e53b5d8.56e33a&amp;#34;,&amp;#34;type&amp;#34;:&amp;#34;mqtt-broker&amp;#34;,&amp;#34;z&amp;#34;:&amp;#34;&amp;#34;,&amp;#34;name&amp;#34;:&amp;#34;MQTTonRasp&amp;#34;,&amp;#34;broker&amp;#34;:&amp;#34;192.168.2.61&amp;#34;,&amp;#34;port&amp;#34;:&amp;#34;1883&amp;#34;,&amp;#34;clientid&amp;#34;:&amp;#34;&amp;#34;,&amp;#34;usetls&amp;#34;:false,&amp;#34;compatmode&amp;#34;:true,&amp;#34;keepalive&amp;#34;:&amp;#34;60&amp;#34;,&amp;#34;cleansession&amp;#34;:true,&amp;#34;birthTopic&amp;#34;:&amp;#34;&amp;#34;,&amp;#34;birthQos&amp;#34;:&amp;#34;0&amp;#34;,&amp;#34;birthPayload&amp;#34;:&amp;#34;&amp;#34;,&amp;#34;closeTopic&amp;#34;:&amp;#34;&amp;#34;,&amp;#34;closeQos&amp;#34;:&amp;#34;0&amp;#34;,&amp;#34;closePayload&amp;#34;:&amp;#34;&amp;#34;,&amp;#34;willTopic&amp;#34;:&amp;#34;&amp;#34;,&amp;#34;willQos&amp;#34;:&amp;#34;0&amp;#34;,&amp;#34;willPayload&amp;#34;:&amp;#34;&amp;#34;},{&amp;#34;id&amp;#34;:&amp;#34;4c36a4e3.de153c&amp;#34;,&amp;#34;type&amp;#34;:&amp;#34;homekit-bridge&amp;#34;,&amp;#34;z&amp;#34;:&amp;#34;&amp;#34;,&amp;#34;bridgeName&amp;#34;:&amp;#34;BridgeOnNodeRed&amp;#34;,&amp;#34;pinCode&amp;#34;:&amp;#34;111-11-111&amp;#34;,&amp;#34;port&amp;#34;:&amp;#34;&amp;#34;,&amp;#34;allowInsecureRequest&amp;#34;:false,&amp;#34;manufacturer&amp;#34;:&amp;#34;JeroVanl&amp;#34;,&amp;#34;model&amp;#34;:&amp;#34;MQTT_Talk&amp;#34;,&amp;#34;serialNo&amp;#34;:&amp;#34;24/03/2019&amp;#34;,&amp;#34;customMdnsConfig&amp;#34;:false,&amp;#34;mdnsMulticast&amp;#34;:true,&amp;#34;mdnsInterface&amp;#34;:&amp;#34;&amp;#34;,&amp;#34;mdnsPort&amp;#34;:&amp;#34;&amp;#34;,&amp;#34;mdnsIp&amp;#34;:&amp;#34;&amp;#34;,&amp;#34;mdnsTtl&amp;#34;:&amp;#34;&amp;#34;,&amp;#34;mdnsLoopback&amp;#34;:true,&amp;#34;mdnsReuseAddr&amp;#34;:true}]</description></item></channel></rss>