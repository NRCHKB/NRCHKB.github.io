<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>kilbamoo on</title><link>https://nrchkb.github.io/contributors/kilbamoo/</link><description>Recent content in kilbamoo on</description><generator>Hugo -- gohugo.io</generator><language>en</language><lastBuildDate>Sat, 17 Apr 2021 18:50:12 +0000</lastBuildDate><atom:link href="https://nrchkb.github.io/contributors/kilbamoo/index.xml" rel="self" type="application/rss+xml"/><item><title>Light Sensor</title><link>https://nrchkb.github.io/wiki/service/light-sensor/</link><pubDate>Sat, 17 Apr 2021 18:50:12 +0000</pubDate><guid>https://nrchkb.github.io/wiki/service/light-sensor/</guid><description>Examples Example below uses tasmota firmware on an esp board to get ambient light level. Using TSL2561 light sensor. Modify mqtt topic, mqtt broker, homekit bridge name as needed. First it gets the mqtt topic, converts it to json. From payload, we subtract the luminance and convert it to an integer with expected property for light sensor.
[{&amp;quot;id&amp;quot;:&amp;quot;c11c22b3.917f2&amp;quot;,&amp;quot;type&amp;quot;:&amp;quot;mqtt in&amp;quot;,&amp;quot;z&amp;quot;:&amp;quot;8ac667fa.c2cec8&amp;quot;,&amp;quot;name&amp;quot;:&amp;quot;sonoff12&amp;quot;,&amp;quot;topic&amp;quot;:&amp;quot;tele/sonoff12/SENSOR&amp;quot;,&amp;quot;qos&amp;quot;:&amp;quot;2&amp;quot;,&amp;quot;datatype&amp;quot;:&amp;quot;auto&amp;quot;,&amp;quot;broker&amp;quot;:&amp;quot;1e53b5d8.56e33a&amp;quot;,&amp;quot;x&amp;quot;:76,&amp;quot;y&amp;quot;:412,&amp;quot;wires&amp;quot;:[[&amp;quot;79b3e787.48c528&amp;quot;]]},{&amp;quot;id&amp;quot;:&amp;quot;79b3e787.48c528&amp;quot;,&amp;quot;type&amp;quot;:&amp;quot;json&amp;quot;,&amp;quot;z&amp;quot;:&amp;quot;8ac667fa.c2cec8&amp;quot;,&amp;quot;name&amp;quot;:&amp;quot;&amp;quot;,&amp;quot;property&amp;quot;:&amp;quot;payload&amp;quot;,&amp;quot;action&amp;quot;:&amp;quot;&amp;quot;,&amp;quot;pretty&amp;quot;:false,&amp;quot;x&amp;quot;:239,&amp;quot;y&amp;quot;:413,&amp;quot;wires&amp;quot;:[[&amp;quot;6eb3b1bc.61b1d&amp;quot;]]},{&amp;quot;id&amp;quot;:&amp;quot;9f8da133.70e86&amp;quot;,&amp;quot;type&amp;quot;:&amp;quot;debug&amp;quot;,&amp;quot;z&amp;quot;:&amp;quot;8ac667fa.c2cec8&amp;quot;,&amp;quot;name&amp;quot;:&amp;quot;&amp;quot;,&amp;quot;active&amp;quot;:false,&amp;quot;tosidebar&amp;quot;:true,&amp;quot;console&amp;quot;:false,&amp;quot;tostatus&amp;quot;:false,&amp;quot;complete&amp;quot;:&amp;quot;payload&amp;quot;,&amp;quot;targetType&amp;quot;:&amp;quot;msg&amp;quot;,&amp;quot;x&amp;quot;:646,&amp;quot;y&amp;quot;:475,&amp;quot;wires&amp;quot;:[]},{&amp;quot;id&amp;quot;:&amp;quot;6eb3b1bc.61b1d&amp;quot;,&amp;quot;type&amp;quot;:&amp;quot;function&amp;quot;,&amp;quot;z&amp;quot;:&amp;quot;8ac667fa.c2cec8&amp;quot;,&amp;quot;name&amp;quot;:&amp;quot;GetLumi&amp;quot;,&amp;quot;func&amp;quot;:&amp;quot;msg.payload = {\n CurrentAmbientLightLevel\t: parseInt(msg.payload.TSL2561.Illuminance)\n}\nreturn msg;\n&amp;quot;,&amp;quot;outputs&amp;quot;:1,&amp;quot;noerr&amp;quot;:0,&amp;quot;x&amp;quot;:403,&amp;quot;y&amp;quot;:413,&amp;quot;wires&amp;quot;:[[&amp;quot;9f8da133.70e86&amp;quot;,&amp;quot;8742cf23.9c419&amp;quot;]]},{&amp;quot;id&amp;quot;:&amp;quot;8742cf23.9c419&amp;quot;,&amp;quot;type&amp;quot;:&amp;quot;homekit-service&amp;quot;,&amp;quot;z&amp;quot;:&amp;quot;8ac667fa.c2cec8&amp;quot;,&amp;quot;isParent&amp;quot;:true,&amp;quot;bridge&amp;quot;:&amp;quot;4c36a4e3.de153c&amp;quot;,&amp;quot;parentService&amp;quot;:&amp;quot;&amp;quot;,&amp;quot;name&amp;quot;:&amp;quot;LichtNiveau&amp;quot;,&amp;quot;serviceName&amp;quot;:&amp;quot;LightSensor&amp;quot;,&amp;quot;topic&amp;quot;:&amp;quot;&amp;quot;,&amp;quot;filter&amp;quot;:false,&amp;quot;manufacturer&amp;quot;:&amp;quot;JeroVanl&amp;quot;,&amp;quot;model&amp;quot;:&amp;quot;TSL2561&amp;quot;,&amp;quot;serialNo&amp;quot;:&amp;quot;01/04/2019&amp;quot;,&amp;quot;characteristicProperties&amp;quot;:&amp;quot;{}&amp;quot;,&amp;quot;x&amp;quot;:652,&amp;quot;y&amp;quot;:414,&amp;quot;wires&amp;quot;:[[]]},{&amp;quot;id&amp;quot;:&amp;quot;1e53b5d8.56e33a&amp;quot;,&amp;quot;type&amp;quot;:&amp;quot;mqtt-broker&amp;quot;,&amp;quot;z&amp;quot;:&amp;quot;&amp;quot;,&amp;quot;name&amp;quot;:&amp;quot;MQTTonRasp&amp;quot;,&amp;quot;broker&amp;quot;:&amp;quot;192.168.2.61&amp;quot;,&amp;quot;port&amp;quot;:&amp;quot;1883&amp;quot;,&amp;quot;clientid&amp;quot;:&amp;quot;&amp;quot;,&amp;quot;usetls&amp;quot;:false,&amp;quot;compatmode&amp;quot;:true,&amp;quot;keepalive&amp;quot;:&amp;quot;60&amp;quot;,&amp;quot;cleansession&amp;quot;:true,&amp;quot;birthTopic&amp;quot;:&amp;quot;&amp;quot;,&amp;quot;birthQos&amp;quot;:&amp;quot;0&amp;quot;,&amp;quot;birthPayload&amp;quot;:&amp;quot;&amp;quot;,&amp;quot;closeTopic&amp;quot;:&amp;quot;&amp;quot;,&amp;quot;closeQos&amp;quot;:&amp;quot;0&amp;quot;,&amp;quot;closePayload&amp;quot;:&amp;quot;&amp;quot;,&amp;quot;willTopic&amp;quot;:&amp;quot;&amp;quot;,&amp;quot;willQos&amp;quot;:&amp;quot;0&amp;quot;,&amp;quot;willPayload&amp;quot;:&amp;quot;&amp;quot;},{&amp;quot;id&amp;quot;:&amp;quot;4c36a4e3.de153c&amp;quot;,&amp;quot;type&amp;quot;:&amp;quot;homekit-bridge&amp;quot;,&amp;quot;z&amp;quot;:&amp;quot;&amp;quot;,&amp;quot;bridgeName&amp;quot;:&amp;quot;BridgeOnNodeRed&amp;quot;,&amp;quot;pinCode&amp;quot;:&amp;quot;111-11-111&amp;quot;,&amp;quot;port&amp;quot;:&amp;quot;&amp;quot;,&amp;quot;allowInsecureRequest&amp;quot;:false,&amp;quot;manufacturer&amp;quot;:&amp;quot;JeroVanl&amp;quot;,&amp;quot;model&amp;quot;:&amp;quot;MQTT_Talk&amp;quot;,&amp;quot;serialNo&amp;quot;:&amp;quot;24/03/2019&amp;quot;,&amp;quot;customMdnsConfig&amp;quot;:false,&amp;quot;mdnsMulticast&amp;quot;:true,&amp;quot;mdnsInterface&amp;quot;:&amp;quot;&amp;quot;,&amp;quot;mdnsPort&amp;quot;:&amp;quot;&amp;quot;,&amp;quot;mdnsIp&amp;quot;:&amp;quot;&amp;quot;,&amp;quot;mdnsTtl&amp;quot;:&amp;quot;&amp;quot;,&amp;quot;mdnsLoopback&amp;quot;:true,&amp;quot;mdnsReuseAddr&amp;quot;:true}]</description></item></channel></rss>